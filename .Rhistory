install.packages("tidyverse")
knitr::opts_chunk$set(eval = FALSE, include = FALSE)
dbinom(0:5, size = 5, prob = 1/6)
dbinom(0:5, size = 5:0, prob = 1/6)
dbinom(0:5, size = 5, prob = 1/6)
exercise_2_11 <- function() {
pmat <- sapply(5:0, function(i) dbinom(0:5, size = i, prob = 1/6))
pmat
}
exercise_2_11()
exercise_2_11 <- function() {
pmat <- sapply(5:0, function(i) dbinom(0:5, size = i, prob = 1/6))
t(pmat)
}
exercise_2_11()
exercise_2_11 <- function() {
P <- matrix(0, nrow = 6, ncol = 6)
for (i in states) {
for (j in i:5) {
P[i+1, j+1] <- dbinom(j - i, size = 5 - i, prob = 1/6)
}
}
P
}
exercise_2_11()
exercise_2_11 <- function() {
P <- matrix(0, nrow = 6, ncol = 6)
for (i in 0:5) {
for (j in i:5) {
P[i+1, j+1] <- dbinom(j - i, size = 5 - i, prob = 1/6)
}
}
P
}
exercise_2_11()
exercise_2_11 <- function() {
P <- matrix(0, nrow = 6, ncol = 6)
for (i in 0:5) {
for (j in i:5) {
P[i+1, j+1] <- dbinom(j - i, size = 5 - i, prob = 1/6)
}
}
P %^% 3
}
exercise_2_11()
library(expm)
install.packages("expm")
exercise_2_11()
library(expm)
exercise_2_11()
exercise_2_11 <- function() {
P <- matrix(0, nrow = 6, ncol = 6)
for (i in 0:5) {
for (j in i:5) {
P[i+1, j+1] <- dbinom(j - i, size = 5 - i, prob = 1/6)
}
}
c(1, 0, 0, 0, 0, 0) %*% (P %^% 3)
}
exercise_2_11()
exercise_2_11c <- function(n) {
P <- matrix(0, nrow = 6, ncol = 6)
for (i in 0:5) {
for (j in i:5) {
P[i+1, j+1] <- dbinom(j - i, size = 5 - i, prob = 1/6)
}
}
P %^% 100
}
exercise_2_11c()
pnorm(1, sd = sqrt(2))
knitr::opts_chunk$set(echo = TRUE)
wiener_process <- function(t) {
# time t
# steps n
n <- 1000
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
steps <- seq(0,t,length = n+1)
bm
}
t <- 3
s <- 9
wiener_process(s)
pnorm(3/sqrt(2))
wiener_process(2)
wiener_process(2)[1001]
replicate(1000, wiener_process(2)[1001])
mean(replicate(1000, wiener_process(2)[1001]) < 3)
2 * rnorm(1000) + rnorm(1000)
mean(2 * rnorm(1000) + rnorm(1000) > 5)
pnorm(sd = sqrt(5))
pnorm(5, sd = sqrt(5))
1-pnorm(5, sd = sqrt(5))
rnorm(1000, mean = 0, sd = 1/2)
mean(rnorm(1000, mean = 0, sd = 1/2) > -7.5/2)
mean(rnorm(1000, mean = 0, sd = 1/2) > -(1/2)/2)
mean(rnorm(1000, mean = 0, sd = 1/2) > -(3/2)/2)
pnorm(sd = 3/2)
pnorm(q = 3/2)
mean(rnorm(1000, mean = 0, sd = 1/2) > -(9/2)/2)
mean(rnorm(10000, mean = 0, sd = 1/2) > -(0.3/2)/2)
pnorm(q = 0.3/4)
pnorm(1/4)
pnorm(1)
knitr::opts_chunk$set(echo = TRUE)
wiener_process(3)
length(c(0,0,0))
# brownian bridge:
bm <- wiener_process(3)
bm - bm[length(bm)]
seq(3, length = 1001)
seq(0, 3, length = 1001)
bm - seq(0, 3, length = 1001) / 3 * bm[length(bm)]
plot(bm - seq(0, 3, length = 1001) / 3 * bm[length(bm)])
plot(bm - ts / 3 * bm[length(ts)])
# brownian bridge:
bm <- wiener_process(3)
ts <- seq(0, 3, length = 1001)
plot(bm - ts / 3 * bm[length(ts)])
ts[length(ts)*2/3]
brownian_bridge[idx]
idx <- length(ts)*2/3 # pluck the t=2
brownian_bridge[idx]
brownian_bridge <- bm - ts / 3 * bm[length(ts)]
idx <- length(ts)*2/3 # pluck the t=2
brownian_bridge[idx]
exercise_11 <- function() {
# brownian bridge:
bm <- wiener_process(3)
ts <- seq(0, 3, length = 1001)
brownian_bridge <- bm - ts / 3 * bm[length(ts)]
idx <- length(ts)*2/3 # pluck the t=2
brownian_bridge[idx] > 1
}
exercise_11()
replicate(100, exercise_11())
mean(replicate(100, exercise_11()))
pnorm(sqrt(3))
replicate(1000, exercise_11())
exercise_11 <- function() {
# brownian bridge:
bm <- wiener_process(3)
ts <- seq(0, 3, length = 1001)
brownian_bridge <- bm - ts / 3 * bm[length(ts)]
idx <- length(ts)*2/3 # pluck the t=2
brownian_bridge[idx] > 1
}
mean(replicate(1000, exercise_11()))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3/2))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3/2))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3/2))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3/2))
mean(replicate(1000, exercise_11()))
pnorm(sqrt(3/2))
mean(replicate(1000, exercise_11()))
1- pnorm(sqrt(3/2))
mean(replicate(1000, exercise_11()))
1- pnorm(sqrt(3/2))
mean(replicate(1000, exercise_11()))
1- pnorm(sqrt(3/2))
9/sqrt(3)
3 * sqrt(3)
pnorm(-3*sqrt(3)/4)
seq(0, 3, length = 1001)
bm <- wiener_process(3)
ts <- seq(0, 3, length = 1001)
drift_process <- 2 * (bm) - 1.5 - t * ts
plot(ts, drift_process, type = "l")
bm <- wiener_process(3)
ts <- seq(0, 3, length = 1001)
drift_process <- 2 * (bm) - 1.5 - t * ts
plot(ts, drift_process, type = "l")
bm <- wiener_process(3)
ts <- seq(0, 3, length = 1001)
drift_process <- 2 * (bm) - 1.5 - t * ts
plot(ts, drift_process, type = "l")
drift_process[length(ts)] > 0
exercise_14 <- function() {
bm <- wiener_process(3)
ts <- seq(0, 3, length = 1001)
drift_process <- 2 * (bm) - 1.5 - t * ts
drift_process[length(ts)] > 0
}
mean(replicate(1000, exercise_14()) > 0)
mean(replicate(10000, exercise_14()) > 0)
pnorm(-sqrt(3)/2)
pnorm(-sqrt(3)/4)
exercise_14 <- function() {
bm <- wiener_process(3)
ts <- seq(0, 3, length = 1001)
drift_process <- 2 * (bm) + 1.5 - t * ts
drift_process[length(ts)] > 0
}
mean(replicate(10000, exercise_14()) > 0)
exercise_14 <- function() {
bm <- wiener_process(3)
ts <- seq(0, 3, length = 1001)
drift_process <- 2 * (bm) + 1.5 - 1 * ts
drift_process[length(ts)] > 0
}
mean(replicate(10000, exercise_14()) > 0)
plot(bm)
plot(bm, type = "l")
knitr::opts_chunk$set(echo = TRUE)
# reflecting across a
reflection_principle <- function(a) {
n <- 1000
t <- 3
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
steps <- seq(0,t,length = n+1)
bm
}
plot(reflection_principle(3))
# reflecting across a
reflection_principle <- function(a) {
n <- 1000
t <- 1
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
xs <- seq(0,t,length = n+1)
p <- plot(xs, bm, type = "l")
p <- abline(h = a)
p
}
reflection_principle(2)
# reflecting across a
reflection_principle <- function(a) {
n <- 1000
t <- 3
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
xs <- seq(0,t,length = n+1)
p <- plot(xs, bm, type = "l")
p <- abline(h = a)
p
}
reflection_principle(1)
reflection_principle(1)
reflection_principle(1)
# reflecting across a
reflection_principle <- function(a) {
n <- 1000
t <- 3
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
xs <- seq(0,t,length = n+1)
p <- plot(xs, bm, type = "l")
p <- abline(h = a)
}
reflection_principle(1)
reflection_principle(1)
reflection_principle(0.5)
# reflecting across a
reflection_principle <- function(a) {
n <- 1000
t <- 3
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
xs <- seq(0,t,length = n+1)
p <- plot(xs, bm, type = "l")
p <- plot(xs, a-bm, type = "l", lty = "--")
p <- abline(h = a)
}
reflection_principle(0.5)
# reflecting across a
reflection_principle <- function(a) {
n <- 1000
t <- 3
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
xs <- seq(0,t,length = n+1)
p <- plot(xs, bm, type = "l")
p <- plot(xs, a-bm, type = "l", lty = "-")
p <- abline(h = a)
}
reflection_principle(0.5)
# reflecting across a
reflection_principle <- function(a) {
n <- 1000
t <- 3
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
xs <- seq(0,t,length = n+1)
p <- plot(xs, bm, type = "l")
p <- lines(xs, a-bm, lty = "-")
p <- abline(h = a)
}
reflection_principle(0.5)
# reflecting across a
reflection_principle <- function(a) {
n <- 1000
t <- 3
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
xs <- seq(0,t,length = n+1)
p <- plot(xs, bm, type = "l")
p <- lines(xs, a-bm, lty = "--")
p <- abline(h = a)
}
reflection_principle(0.5)
# reflecting across a
reflection_principle <- function(a) {
n <- 1000
t <- 3
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
xs <- seq(0,t,length = n+1)
p <- plot(xs, bm, type = "l")
p <- lines(xs, a-bm, lty = 2)
p <- abline(h = a)
}
reflection_principle(0.5)
# reflecting across a
reflection_principle <- function(a) {
n <- 1000
t <- 3
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
xs <- seq(0,t,length = n+1)
p <- plot(xs, bm, type = "l")
p <- lines(xs, a-bm, lty = 2)
p <- abline(h = a)
}
reflection_principle(1)
reflection_principle(1)
# reflecting across a
reflection_principle <- function(a) {
n <- 1000
t <- 3
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
xs <- seq(0,t,length = n+1)
p <- plot(xs, bm, type = "l")
p <- lines(xs, 2*a-bm, lty = 2)
p <- abline(h = a)
}
reflection_principle(1)
reflection_principle(1)
reflection_principle(1)
(0.25 + log(40/35))/0.4
pnorm((0.25 + log(40/35))/0.4)
exercise_8_25 <- function() {
n <- 1000
t <- 1
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
xs <- seq(0,t,length = n+1)
drift <- -0.25
vol <- 0.4
initval <- 35
geometric_motion <- initval * exp(drift*xs + vol*bm)
plot(geometric_motion)
}
exercise_8_25()
exercise_8_25()
exercise_8_25()
exercise_8_25()
exercise_8_25()
exercise_8_25 <- function() {
n <- 1000
t <- 1
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
xs <- seq(0,t,length = n+1)
drift <- -0.25
vol <- 0.01
initval <- 35
geometric_motion <- initval * exp(drift*xs + vol*bm)
plot(geometric_motion)
}
exercise_8_25()
exercise_8_25 <- function() {
n <- 1000
t <- 1
bm <- c(0, cumsum(rnorm(n, 0, sqrt(t/n))))
xs <- seq(0,t,length = n+1)
drift <- -0.25
vol <- 0.4
initval <- 35
geometric_motion <- initval * exp(drift*xs + vol*bm)
geometric_motion[n]
}
exercise_8_25()
exercise_8_25()
exercise_8_25()
replicate(1000, exercise_8_25)
replicate(1000, exercise_8_25())
mean(replicate(1000, exercise_8_25()) > 40)
mean(replicate(1e4, exercise_8_25()) > 40)
